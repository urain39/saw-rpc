!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";var a=void 0,o={}.hasOwnProperty,r=(u.prototype.onOpen=function(t){return this._ws.addEventListener("open",t),this._listeners.open.push(t),this},u.prototype.onError=function(t){return this._ws.addEventListener("error",t),this._listeners.error.push(t),this},u.prototype.onClose=function(t){return this._ws.addEventListener("close",t),this._listeners.close.push(t),this},u.prototype.onNotify=function(t,e){return this._notifiers[t]=e,this},u.prototype.request=function(t,e,r,n){return void 0===n&&(n=!1),this._request(t,e,r,n),this},u.prototype._request=function(t,e,r,n,s){var o,i;!n&&this.requestCount>=u.MAX_REQUEST_COUNT&&!s?r(a,{code:u.ERROR_MAX_CONCURRENT,message:"Max concurrent error"}):(s===a&&(s=this._requestId++,n||this.requestCount++),this.isReady?(o={jsonrpc:"2.0",id:s,method:t,params:e},this._ws.send(JSON.stringify(o)),this._handlers[s]=r):(i=this,setTimeout(function(){i._request(t,e,r,n,s)},u.CONNECTION_CHECK_DELAY)))},u.prototype.heartbeat=function(t,e,r){var n=!1,s=this;return setInterval(function(){n&&(s.close(),r(n,a,{code:u.ERROR_HEARTBEAT_TIMEDOUT,message:"Heartbeat timed out"})),n=!0,s.request(t,e,function(t,e){r(n=!1,t,e)},!0)},u.HEARTBEAT_DELAY),this},u.prototype.close=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];(t=this._ws).close.apply(t,e)},u.prototype.reconnect=function(){for(var t=this._listeners,e=new WebSocket(this.rpcPath),r=0,n=t.open;r<n.length;r++){var s=n[r];e.addEventListener("open",s)}for(var o=0,i=t.error;o<i.length;o++){s=i[o];e.addEventListener("error",s)}for(var a=0,u=t.message;a<u.length;a++){s=u[a];e.addEventListener("message",s)}for(var c=0,h=t.close;c<h.length;c++){s=h[c];e.addEventListener("close",s)}return this._ws=e,this},u.MAX_REQUEST_COUNT=8,u.CONNECTION_CHECK_DELAY=1e3,u.HEARTBEAT_DELAY=15e3,u.ERROR_MAX_CONCURRENT=-32032,u.ERROR_HEARTBEAT_TIMEDOUT=-32033,u);function u(t){this.rpcPath=t,this.isReady=!1,this.requestCount=0,this._ws=new WebSocket(this.rpcPath),this._requestId=0,this._listeners={open:[],error:[],message:[],close:[]},this._handlers={},this._notifiers={};var s=this;this.onOpen(function(){s.isReady=!0}),this.onClose(function(){s.isReady=!1}),this._ws.addEventListener("message",t=function(t){var e=JSON.parse(t.data);if(o.call(e,"id")){var r=e.id,n=s._handlers;if(o.call(n,r)){t=n[r];if(o.call(e,"result"))t(e.result,a);else{if(!o.call(e,"error"))throw new Error("Invalid response with no `result` or `error`");t(a,e.error)}n[r]=a,s.requestCount--}}else{if(!o.call(e,"method"))throw new Error("Invalid response with no `id` or `method`");n=e.method,r=s._notifiers;o.call(r,n)&&(n=r[n],(e=e.params)&&n(e))}}),this._listeners.message.push(t)}var s=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var o=arguments[e],i=0,a=o.length;i<a;i++,s++)n[s]=o[i];return n},i=void 0,t=(e.prototype.onNotify=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];(t=this._jsonrpc).onNotify.apply(t,e)},e.prototype.request=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this._jsonrpc;return new Promise(function(r){n.request.apply(n,s([t],e,[function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(t)}]))})},e.prototype.addUri=function(t,e,r){t=[this._secret,t];return e&&(t.push(e),r!==i&&t.push(r)),this.request("aria2.addUri",t)},e.prototype.addTorrent=function(t,e,r,n){t=[this._secret,t];return e&&(t.push(e),r&&(t.push(r),n!==i&&t.push(n))),this.request("aria2.addTorrent",t)},e.prototype.addMetalink=function(t,e,r){t=[this._secret,t];return e&&(t.push(e),r!==i&&t.push(r)),this.request("aria2.addMetalink",t)},e.prototype.remove=function(t){t=[this._secret,t];return this.request("aria2.remove",t)},e.prototype.forceRemove=function(t){t=[this._secret,t];return this.request("aria2.forceRemove",t)},e.prototype.pause=function(t){t=[this._secret,t];return this.request("aria2.pause",t)},e.prototype.pauseAll=function(){var t=[this._secret];return this.request("aria2.pauseAll",t)},e.prototype.forcePause=function(t){t=[this._secret,t];return this.request("aria2.forcePause",t)},e.prototype.forcePauseAll=function(){var t=[this._secret];return this.request("aria2.forcePauseAll",t)},e.prototype.unpause=function(t){t=[this._secret,t];return this.request("aria2.unpause",t)},e.prototype.unpauseAll=function(){var t=[this._secret];return this.request("aria2.unpauseAll",t)},e.prototype.tellStatus=function(t,e){t=[this._secret,t];return e&&t.push(e),this.request("aria2.tellStatus",t)},e);function e(t,e){this.rpcPath=t,this._secret="token:"+e,this._jsonrpc=new r(t)}var n=function(t,i,a,u){return new(a=a||Promise)(function(r,e){function n(t){try{o(u.next(t))}catch(t){e(t)}}function s(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?r(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(n,s)}o((u=u.apply(t,i||[])).next())})},c=function(r,n){var s,o,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(i=2&e[0]?o.return:e[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,e[1])).done)return i;switch(o=0,(e=i?[2&e[0],i.value]:e)[0]){case 0:case 1:i=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){a.label=e[1];break}if(6===e[0]&&a.label<i[1]){a.label=i[1],i=e;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(e);break}i[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(r,a)}catch(t){e=[6,t],o=0}finally{s=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},h=new t("ws://localhost:6800/jsonrpc","arcticfox");!function(){n(this,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:return r=(e=console).log,[4,h.tellStatus("72af75660910724e",["dir","status"])];case 1:return r.apply(e,[t.sent()]),[2]}})})}()});
